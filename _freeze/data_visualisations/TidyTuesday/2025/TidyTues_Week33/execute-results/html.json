{
  "hash": "8a71e1d52578b8eca50d61b6ce021a13",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"TidyTuesday Week 33: Scott\"\nsubtitle: \"A Munro is a Scottish mountain with an elevation of over 3,000 feet, whereas a Munro Top is a subsidiary summit of a Munro that also exceeds 3,000 feet in height but is not considered a distinct mountain in its own right. The most famous Munro is Ben Nevis.\"\nauthor: \"Peter Gray\"\ndate: \"2025-08-19\" \ncategories: [\"TidyTuesday\", \"Data Visualization\", \"R Programming\", \"2025\"]\ntags: [tidytuesday, R, data visulation, ggplot2, tidyverse]\nimage: \"thumbnails/TidyTues_Week33.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: false\n    code-summary: \"Show code\"\n    self-contained: true\neditor_options: \n  chunk_output_type: console\nexecute: \n  freeze: true                                                  \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n\n![Chart](thumbnails/TidyTues_Week33.png){#fig-singlechart}\nChange in Munro Status\n:::\n\n#### 1. R code\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the packages in ----------------------------------------------------\n\nif (!require(tidyverse)) {\n  install.packages(\"tidyverse\")\n  library(tidyverse)\n}\nif (!require(patchwork)) {\n  install.packages(\"patchwork\")\n  library(patchwork)\n}\nif (!require(ggplot2)) {\n  install.packages(\"ggplot2\")\n  library(ggplot2)\n}\nif (!require(ggalluvial)) {\n  install.packages(\"ggalluvial\")\n  library(ggalluvial)\n}\nif (!require(scales)) {\n  install.packages(\"scales\")\n  library(scales)\n}\nif (!require(RColorBrewer)) {\n  install.packages(\"RColorBrewer\")\n  library(RColorBrewer)\n}\n# I stick all my styling into a CUsotm PAckage to tidy up my code and keep it consistent over the time\nif (!require(CustomGGPlot2Theme)) {\n  devtools::install(\"CustomGGPlot2Theme\")\n  library(CustomGGPlot2Theme)\n}\n\n\nscottish_munros <- readr::read_csv(\n  'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-08-19/scottish_munros.csv'\n)\n\n\nmunros_long <- scottish_munros |>\n  pivot_longer(\n    cols = `1891`:`2021`,\n    names_to = \"Year\",\n    values_to = \"Classification\"\n  )\n\nduplicate <- munros_long |>\n  filter(!is.na(Classification)) |>\n  group_by(Name) |>\n  summarise(n = n_distinct(Classification)) |>\n  filter(n >= 2)\n\nmunros_clean <- munros_long |>\n  filter(Name %in% duplicate$Name) |>\n  filter(!is.na(Classification)) |>\n  arrange(Name, Year) |>\n  group_by(Name, Year) |>\n  slice(1) |>\n  ungroup() |>\n  mutate(Year = factor(Year, levels = sort(unique(Year))))\n\nnumbers <- munros_clean |>\n  group_by(Year, Classification) |>\n  summarise(n = n(), .groups = \"drop\") |>\n  group_by(Year) |>\n  mutate(pct = n / sum(n) * 100, y = 60 / 2)\n\ntitle = \"Alluvial Plot of Scottish Munro classifications that have changed over the years\"\n\np1 <- ggplot(\n  munros_clean,\n  aes(\n    x = Year,\n    stratum = Classification,\n    alluvium = Name,\n    fill = Classification\n  )\n) +\n  geom_flow(stat = \"alluvium\") +\n  geom_stratum() +\n  geom_text(\n    data = numbers,\n    aes(\n      x = Year,\n      y = y,\n      stratum = Classification,\n      label = paste0(n, \"\\n\", round(pct, digits = 0), \"%\")\n    ),\n    stat = \"stratum\",\n    inherit.aes = F,\n    size = 4,\n    color = \"black\"\n  ) +\n  Custom_Style() +\n  theme(\n    legend.title = element_blank(),\n    axis.ticks.y = element_blank(),\n    axis.title.y = element_text(\n      margin = margin(r = 15)\n    ),\n    legend.key.height = unit(1, \"cm\"),\n    legend.key.width = unit(0.5, \"cm\")\n  ) +\n  guides(fill = guide_legend(nrow = 2)) +\n  labs(title = str_wrap(title, 40), y = \"Number of Scottish Munros\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}