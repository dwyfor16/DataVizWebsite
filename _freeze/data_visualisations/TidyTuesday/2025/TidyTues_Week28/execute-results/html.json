{
  "hash": "dcb79ec09ccf523dd0a66e54b2927a2b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"TidyTuesday Week 28: British Library Funding\"\nsubtitle: \"This week we're looking into British Library funding!\"\nauthor: \"Peter Gray\"\ndate: \"2025-07-15\" \ncategories: [\"TidyTuesday\", \"Data Visualization\", \"R Programming\" , \"2025\"]\ntags: [tidytuesday, R, data visulation, Python Programming, Pandas]\nimage: \"thumbnails/TidyTues_Week28.png\"\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: false\n    code-summary: \"Show code\"\n    self-contained: true\neditor_options: \n  chunk_output_type: console\nexecute: \n  freeze: true                                                  \n  cache: true                                                   \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n\n![Chart](thumbnails/TidyTues_Week28.png){#fig-singlechart}\nBritish Library Funding\n\n:::\n#### 1. R code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(tidyverse)){install.packages(\"tidyverse\"); library(tidyverse)}\nif(!require(scales)){install.packages(\"scales\"); library(scales)}\nif(!require(CustomGGPlot2Theme)){devtools::install(\"CustomGGPlot2Theme\"); library(CustomGGPlot2Theme)}\n\n\nbl_funding <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-07-15/bl_funding.csv')\n\n\ngap <-  bl_funding |> \n  select(year,  gia_y2000_gbp_millions, voluntary_y2000_gbp_millions, investment_y2000_gbp_millions, services_y2000_gbp_millions)\n\n\ngap_long <- gap |> \n  pivot_longer(\n    cols = -starts_with(\"year\"),\n    names_to = \"funding_source\",\n    values_to = \"funding\"\n  )    |> \n  mutate(funding_source = case_when(\n    funding_source == \"gia_y2000_gbp_millions\" ~ \"Government\",\n    funding_source == \"voluntary_y2000_gbp_millions\" ~ \"Voluntary\",\n    funding_source == \"investment_y2000_gbp_millions\" ~ \"Investment\",\n    funding_source == \"services_y2000_gbp_millions\" ~ \"Services\",\n    TRUE ~ funding_source\n  ))\n\n\nevents <- data.frame(\n  year = c(2010),\n  event = c(\"Tories voted in\")\n)\n\ngap_plot <- ggplot(gap_long, aes(x = year, y = funding, fill = funding_source)) +\n  geom_area(color = \"black\", size = 0.2, alpha = 0.8) +\n  scale_y_continuous(labels = label_dollar(prefix = \"£\")) +\n  labs(\n    title = \"Proportion of British Library Funding by Source)\",\n    x = \"Year\",\n    y = \"Percentage of Total Funding (£ millions)\",\n    fill = \"Funding Source\"\n  ) +\n  geom_text(\n    data = events,\n    aes(x = year, y = 105, label = event),\n    angle = 90,\n    vjust = -0.5,\n    hjust = 0,\n    size = 3,\n    inherit.aes = FALSE\n  ) +\n  Custom_Style()  +\n  theme(\n  legend.position = \"right\",\n  text = element_text(size = 10),  \n  axis.title = element_text(size = 10),\n  axis.text = element_text(size = 10),\n  legend.title = element_text(size = 10),\n  legend.text = element_text(size = 10),\n  axis.title.y = element_text(size = 10, margin = margin(r = 10)),\n  plot.title = element_text(size = 10)) +  \n  geom_vline(data = events, aes(xintercept = year), linetype = \"dashed\", color = \"black\") \n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}