---
format:
  pdf:
    geometry: a4paper, landscape
    keep-tex: true
    toc: true
    lot: true
    mainfont: "Times New Roman"
    fontsize: 12pt
    includes:
      in-header: header.tex
project:
  type: default
  output-dir: "Outputs"
editor_options: 
  chunk_output_type: console
---
```{=latex}
\thispagestyle{empty}
\begin{center}
\vspace*{2cm}
\includegraphics[width=0.3\textwidth]{images/logo.png}

\vspace{1cm}
{\LARGE \textbf{Baseline Characteristics Table}}

\vspace{0.5cm}
{\large Generated with R and Quarto}

\vfill
\end{center}
\newpage
```


```{r, load the packages needed}
#| warning: false
#| echo: false

source("~/Documents/Coding/Website/biostatistics/00 Functions/Functions.R")
clean_up()

if(!require(tidyverse)){install.packages("tidyverse"); library(tidyverse)}
if(!require(pharmaverse)){install.packages("pharmaverse"); library(pharmaverse)}
if(!require(pharmaverseadam)){install.packages("pharmaverseadam"); library(pharmaverseadam)}
if(!require(gtsummary)){install.packages("gtsummary"); library(gtsummary)}
if(!require(gt)){install.packages("gt"); library(gt)}  # also contains OfficeR
if(!require(remotes)){install.packages("remotes"); library(remotes)}
if (!require(cardinal)) {remotes::install_github("pharmaverse/cardinal"); library(cardinal)}
if(!require(random.cdisc.data)){install.packages("random.cdisc.data"); library(random.cdisc.data)}
if(!require(kableExtra)){install.packages("kableExtra"); library(kableExtra)}

#working directory for save

wd = getwd()

load("~/Documents/Coding/Website/biostatistics/Data/Data_Processed.RDS")
```

\newpage

```{r, build the table}
#| warning: false
#| echo: false


adsl_x <- adsl |> 
  select(TRT01P, AGE, AGEGRP1, SEX, RACE, ETHNIC, RACE_BLACK, REGION1, HIGHBP, OVER80KG)


adsl_table <- adsl_x |> 
  tbl_summary(by = TRT01P,
              type = all_continuous() ~ "continuous2",
              statistic = list(
                AGE ~ c("{mean} ({sd})", "({p25}, {p75})", "{min}, {max}"),
                all_categorical() ~ "{n} ({p}%)"),
              label = list(
                AGE ~ "Age",
                AGEGRP1 ~ "Age Group",
                SEX ~ "Gender",
                RACE ~ "Race", 
                ETHNIC ~ "Ethnicity",
                RACE_BLACK ~ "African American",
                REGION1 ~ "Region",
                HIGHBP ~ "High Blood Pressure  \n >(130/ 80)",
                OVER80KG ~ "Weight Over 80kg"
              )) |>
  add_overall(last = TRUE) |> 
  bold_labels() |>   
  modify_header(label ~ "**Variable**") |> 
  modify_spanning_header(c("stat_1", "stat_2", "stat_3") ~ "**Treatment Received**")  |> 
  modify_caption("Baseline Characteristics")

adsl_table_kable <- adsl_table %>% 
  as_kable_extra(
    booktabs = TRUE,
    longtable = TRUE,
    linesep = ""
  ) |>
  kableExtra::kable_styling(
    position = "left",
    latex_options = c("repeat_header")
  )

adsl_table_kable

```
